<div class="flex h-screen bg-gray-100">
  <!-- Sidebar -->
  <aside
    [ngClass]="{ 'w-64': !collapsed, 'w-20': collapsed }"
    class="bg-white shadow-lg p-4 transition-all duration-300 flex flex-col h-screen relative"
  >
    <!-- Scrollable content -->
    <div class="flex-1 overflow-y-auto">
      <!-- Sidebar header -->
      <div class="flex items-center justify-between mb-6">
        <h2
          *ngIf="!collapsed"
          class="text-xl font-bold flex items-center space-x-2"
        >
          <i class="fas fa-link text-2xl animate-spin text-pink-500"></i>
          <span
            class="bg-clip-text text-transparent bg-gradient-to-r from-teal-500 via-purple-500 to-blue-500"
          >
            Quick Links
          </span>
        </h2>

        <button
          (click)="collapsed = !collapsed"
          class="relative text-gray-600 transition group p-2 rounded hover:bg-gray-100"
          title="Toggle Sidebar"
        >
          <i
            class="fas fa-link text-2xl animate-spin text-pink-500 transition-opacity duration-200 group-hover:opacity-0"
            *ngIf="collapsed"
          ></i>
          <i
            class="fas fa-chevron-right absolute inset-0 flex items-center justify-center opacity-0 transition-opacity duration-200 group-hover:opacity-100"
            *ngIf="collapsed"
          ></i>
          <i class="fas fa-chevron-left" *ngIf="!collapsed"></i>
        </button>
      </div>

      <!-- Sidebar buttons -->
      <ul>
        <li>
          <button
            (click)="filter = 'all'"
            [ngClass]="{
              'bg-gradient-to-r from-teal-400 via-purple-400 to-blue-400 text-white':
                filter === 'all',
              'hover:bg-gray-100 text-gray-700': filter !== 'all'
            }"
            class="w-full text-left px-4 py-4 rounded flex items-center space-x-2 transition-all duration-300"
          >
            <i class="fas fa-list"></i>
            <span *ngIf="!collapsed">All</span>
          </button>
        </li>
        <li>
          <button
            (click)="filter = 'active'"
            [ngClass]="{
              'bg-gradient-to-r from-teal-400 via-purple-400 to-blue-400 text-white':
                filter === 'active',
              'hover:bg-gray-100 text-gray-700': filter !== 'active'
            }"
            class="w-full text-left px-4 py-4 rounded flex items-center space-x-2 transition-all duration-300"
          >
            <i class="fas fa-play"></i>
            <span *ngIf="!collapsed">Active</span>
          </button>
        </li>
        <li>
          <button
            (click)="filter = 'completed'"
            [ngClass]="{
              'bg-gradient-to-r from-teal-400 via-purple-400 to-blue-400 text-white':
                filter === 'completed',
              'hover:bg-gray-100 text-gray-700': filter !== 'completed'
            }"
            class="w-full text-left px-4 py-4 rounded flex items-center space-x-2 transition-all duration-300"
          >
            <i class="fas fa-check-circle"></i>
            <span *ngIf="!collapsed">Completed</span>
          </button>
        </li>
      </ul>
    </div>

    <!-- Fixed userinfo at bottom -->
    <div
      class="fixed bottom-2 left-5 border-t border-gray-200 pt-4 bg-white z-50"
      *ngIf="user"
    >
      <div class="flex items-center space-x-3">
        <i class="fas fa-user-circle text-3xl text-gray-500"></i>
        <div *ngIf="!collapsed" class="w-40 flex flex-col">
          <span class="font-medium">{{ user.name }}</span>
          <span class="text-xs text-gray-500">{{ user.email }}</span>
        </div>
      </div>
      <button
        (click)="logout()"
        class="mt-3 w-full bg-red-500 text-white py-1 rounded hover:bg-red-600 transition"
        *ngIf="!collapsed"
      >
        Logout
      </button>
    </div>
  </aside>

  <!-- Main content -->
  <main class="flex-1 p-6 overflow-auto">
    <div class="mb-4 flex">
      <input
        type="text"
        [(ngModel)]="taskName"
        placeholder="Enter task"
        class="flex-1 p-2 rounded-l border border-gray-300"
        (keydown.enter)="addTask()"
      />
      <button
        (click)="addTask()"
        class="bg-blue-500 text-white px-4 rounded-r hover:bg-blue-600 transition"
      >
        Add
      </button>
    </div>

    <ul>
      <li
        *ngFor="let task of filteredTasks()"
        class="bg-white p-4 rounded shadow mb-2 flex items-center justify-between"
      >
        <!-- <div class="flex items-center space-x-4">
          <input
            title="task"
            type="checkbox"
            [(ngModel)]="task.completed"
            (change)="toggleCompleted(task)"
          />
          <span
            [class.line-through]="task.completed"
            [class.opacity-50]="task.completed"
          >
            {{ task.title }}
          </span>
        </div>
        <div class="flex items-center space-x-2">
          <small class="text-gray-400">{{
            task.createdAt | date : "short"
          }}</small>
          <button
            (click)="saveEdit(task)"
            class="bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 transition"
            title="Edit Task"
          >
            <i class="fas fa-edit"></i>
          </button> -->
        <div class="flex items-center space-x-4">
          <input
            title="task"
            type="checkbox"
            [(ngModel)]="task.completed"
            (change)="toggleCompleted(task)"
          />

          <!-- Display or edit -->
          <span
            *ngIf="!task.editing"
            [class.line-through]="task.completed"
            [class.opacity-50]="task.completed"
          >
            {{ task.title }}
          </span>

          <input
            *ngIf="task.editing"
            [(ngModel)]="task.title"
            title="edit"
            (blur)="saveEdit(task)"
            (keydown.enter)="saveEdit(task)"
            class="border p-1 rounded flex-1"
            autofocus
          />
        </div>

        <div class="flex items-center space-x-2">
          <small class="text-gray-400">{{
            task.createdAt | date : "short"
          }}</small>

          <!-- Edit button -->
          <button
            (click)="task.editing = true"
            class="bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 transition"
            title="Edit Task"
          >
            <i class="fas fa-edit"></i>
          </button>

          <div class="flex items-center space-x-2">
            <button
              (click)="removeTask(task._id!)"
              class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 transition"
              title="Delete Task"
            >
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
      </li>
    </ul>
  </main>
</div>
